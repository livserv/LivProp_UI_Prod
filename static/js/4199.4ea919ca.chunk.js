"use strict";(self.webpackChunklib_prop_ui=self.webpackChunklib_prop_ui||[]).push([[4199],{8478:(e,t,n)=>{n.d(t,{Jt:()=>c,TF:()=>p,bE:()=>d,yJ:()=>u});var o=n(89379),a=n(80045),r=n(32026),i=n(44364);const l=["headers","noAuth"],s=["data"];async function c(e,t){return f("GET",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function d(e,t){return f("POST",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function u(e,t){return f("PUT",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function p(e,t){return f("DELETE",e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async function f(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{headers:i,noAuth:c}=r,d=(0,a.A)(r,l);const u="POST"===e||"PUT"===e||"DELETE"===e;t=function(e,t){if(!e)return e;const n=t&&Object.keys(t);if(null!==n&&void 0!==n&&n.length){const o=n.reduce(((e,n)=>{let o=t[n];return null===o||void 0===o?e:(o="".concat(n,"=").concat(encodeURIComponent(o)),e?"".concat(e,"&").concat(o):o)}),"");o&&(e="".concat(e).concat(e.includes("?")?"&":"?").concat(o))}if(e.startsWith("https://"))return e;return"".concat(h).concat(e)}(t,u?void 0:n);const p=n instanceof FormData;if(p||(n=n&&"object"===typeof n&&u?JSON.stringify(n):void 0),i||(i={}),p||(i["Content-Type"]="application/json"),i.Accept="application/json",!1!==c){const e=sessionStorage.getItem("token");e&&(i.Authorization="Bearer ".concat(e))}try{const r=await fetch(t,(0,o.A)((0,o.A)({},d),{},{headers:i,body:n,method:e})),l=await r.json();if(r.ok){const{data:e}=l,t=(0,a.A)(l,s);return delete t.status,e&&!Object.keys(t).length?e:l}throw l.message?new Error(l.message):l}catch(v){var f;throw console.error("Error calling API: ",v),null!==(f=v.message)&&void 0!==f&&f.includes("fetch")?new Error("Unable to reach server. Please check your network connectivity and try again."):new Error(v.message)}}const h=(0,r.s8)(i.jn,"/")},10226:(e,t,n)=>{n.d(t,{A:()=>_});var o=n(98587),a=n(58168),r=n(9950),i=n(72004),l=n(45537),s=n(88465),c=n(9240),d=n(59254),u=n(19608),p=n(18463),f=n(24184),h=n(61676),v=n(1763),g=n(423);function m(e){return(0,g.Ay)("MuiButton",e)}const x=(0,v.A)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const y=r.createContext({});const A=r.createContext(void 0);var w=n(44414);const b=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],S=e=>(0,a.A)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),C=(0,d.Ay)(f.A,{shouldForwardProp:e=>(0,u.A)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["".concat(n.variant).concat((0,h.A)(n.color))],t["size".concat((0,h.A)(n.size))],t["".concat(n.variant,"Size").concat((0,h.A)(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((e=>{let{theme:t,ownerState:n}=e;var o,r;const i="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],l="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return(0,a.A)({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":(0,a.A)({textDecoration:"none",backgroundColor:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,c.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===n.variant&&"inherit"!==n.color&&{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,c.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===n.variant&&"inherit"!==n.color&&{border:"1px solid ".concat((t.vars||t).palette[n.color].main),backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,c.X4)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===n.variant&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:l,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},"contained"===n.variant&&"inherit"!==n.color&&{backgroundColor:(t.vars||t).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[n.color].main}}),"&:active":(0,a.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[8]}),["&.".concat(x.focusVisible)]:(0,a.A)({},"contained"===n.variant&&{boxShadow:(t.vars||t).shadows[6]}),["&.".concat(x.disabled)]:(0,a.A)({color:(t.vars||t).palette.action.disabled},"outlined"===n.variant&&{border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)},"contained"===n.variant&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},"text"===n.variant&&{padding:"6px 8px"},"text"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main},"outlined"===n.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].main,border:t.vars?"1px solid rgba(".concat(t.vars.palette[n.color].mainChannel," / 0.5)"):"1px solid ".concat((0,c.X4)(t.palette[n.color].main,.5))},"contained"===n.variant&&{color:t.vars?t.vars.palette.text.primary:null==(o=(r=t.palette).getContrastText)?void 0:o.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:i,boxShadow:(t.vars||t).shadows[2]},"contained"===n.variant&&"inherit"!==n.color&&{color:(t.vars||t).palette[n.color].contrastText,backgroundColor:(t.vars||t).palette[n.color].main},"inherit"===n.color&&{color:"inherit",borderColor:"currentColor"},"small"===n.size&&"text"===n.variant&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"text"===n.variant&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"outlined"===n.variant&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"outlined"===n.variant&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},"small"===n.size&&"contained"===n.variant&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},"large"===n.size&&"contained"===n.variant&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})}),(e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(x.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(x.disabled)]:{boxShadow:"none"}}})),E=(0,d.Ay)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t["iconSize".concat((0,h.A)(n.size))]]}})((e=>{let{ownerState:t}=e;return(0,a.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},S(t))})),I=(0,d.Ay)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t["iconSize".concat((0,h.A)(n.size))]]}})((e=>{let{ownerState:t}=e;return(0,a.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},S(t))})),_=r.forwardRef((function(e,t){const n=r.useContext(y),c=r.useContext(A),d=(0,l.A)(n,e),u=(0,p.b)({props:d,name:"MuiButton"}),{children:f,color:v="primary",component:g="button",className:x,disabled:S=!1,disableElevation:_=!1,disableFocusRipple:T=!1,endIcon:P,focusVisibleClassName:k,fullWidth:z=!1,size:j="medium",startIcon:R,type:D,variant:N="text"}=u,O=(0,o.A)(u,b),F=(0,a.A)({},u,{color:v,component:g,disabled:S,disableElevation:_,disableFocusRipple:T,fullWidth:z,size:j,type:D,variant:N}),M=(e=>{const{color:t,disableElevation:n,fullWidth:o,size:r,variant:i,classes:l}=e,c={root:["root",i,"".concat(i).concat((0,h.A)(t)),"size".concat((0,h.A)(r)),"".concat(i,"Size").concat((0,h.A)(r)),"color".concat((0,h.A)(t)),n&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["icon","startIcon","iconSize".concat((0,h.A)(r))],endIcon:["icon","endIcon","iconSize".concat((0,h.A)(r))]},d=(0,s.A)(c,m,l);return(0,a.A)({},l,d)})(F),L=R&&(0,w.jsx)(E,{className:M.startIcon,ownerState:F,children:R}),B=P&&(0,w.jsx)(I,{className:M.endIcon,ownerState:F,children:P}),W=c||"";return(0,w.jsxs)(C,(0,a.A)({ownerState:F,className:(0,i.A)(n.className,M.root,x,W),component:g,disabled:S,focusRipple:!T,focusVisibleClassName:(0,i.A)(M.focusVisible,k),ref:t,type:D},O,{classes:M,children:[L,f,B]}))}))},24516:(e,t,n)=>{n.d(t,{A:()=>w});var o=n(98587),a=n(58168),r=n(9950),i=n(72004),l=n(88465),s=n(68624),c=n(39766),d=n(59254),u=n(61676),p=n(1763),f=n(423);function h(e){return(0,f.Ay)("MuiFormHelperText",e)}const v=(0,p.A)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var g,m=n(18463),x=n(44414);const y=["children","className","component","disabled","error","filled","focused","margin","required","variant"],A=(0,d.Ay)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t["size".concat((0,u.A)(n.size))],n.contained&&t.contained,n.filled&&t.filled]}})((e=>{let{theme:t,ownerState:n}=e;return(0,a.A)({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,["&.".concat(v.disabled)]:{color:(t.vars||t).palette.text.disabled},["&.".concat(v.error)]:{color:(t.vars||t).palette.error.main}},"small"===n.size&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})})),w=r.forwardRef((function(e,t){const n=(0,m.b)({props:e,name:"MuiFormHelperText"}),{children:r,className:d,component:p="p"}=n,f=(0,o.A)(n,y),v=(0,c.A)(),w=(0,s.A)({props:n,muiFormControl:v,states:["variant","size","disabled","error","filled","focused","required"]}),b=(0,a.A)({},n,{component:p,contained:"filled"===w.variant||"outlined"===w.variant,variant:w.variant,size:w.size,disabled:w.disabled,error:w.error,filled:w.filled,focused:w.focused,required:w.required}),S=(e=>{const{classes:t,contained:n,size:o,disabled:a,error:r,filled:i,focused:s,required:c}=e,d={root:["root",a&&"disabled",r&&"error",o&&"size".concat((0,u.A)(o)),n&&"contained",s&&"focused",i&&"filled",c&&"required"]};return(0,l.A)(d,h,t)})(b);return(0,x.jsx)(A,(0,a.A)({as:p,ownerState:b,className:(0,i.A)(S.root,d),ref:t},f,{children:" "===r?g||(g=(0,x.jsx)("span",{className:"notranslate",children:"\u200b"})):r}))}))},28564:(e,t,n)=>{n.d(t,{C7:()=>c,CC:()=>u,EO:()=>r,EZ:()=>s,Ek:()=>d,Gl:()=>i,Jc:()=>l});var o=n(33340),a=n(8478);async function r(e){const{selectedBotId:t,organizationId:n}=o.nc.getState();return await i(n,t,e)}async function i(e,t,n){return await a.Jt("/bot/".concat(e,"/").concat(t,"/chat-flow/").concat(n))}async function l(e){try{const{selectedBotId:t,organizationId:n}=o.nc.getState(),r=await a.Jt("/bot/".concat(n,"/").concat(t,"/chat-flow/").concat(e,"/startup"));if("string"===typeof r&&r.startsWith("<"))throw new Error("Invalid JSON response, received HTML");return r}catch(t){return console.error("Error fetching startup with Flow ID:",t),null}}async function s(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=o.nc.getState();e||(e=i.organizationId),t||(t=i.selectedBotId);const l="/bot/".concat(e,"/").concat(t,"/chat-flow").concat(r?"?deploy=true":"");return await a.bE(l,n)}async function c(e,t,n){return await a.TF("/bot/".concat(e,"/").concat(t,"/chat-flow/").concat(n))}async function d(){const{selectedBotId:e,organizationId:t}=o.nc.getState();return(await a.Jt("/bot/".concat(t,"/").concat(e,"/chat-flow"))).map(u).sort(((e,t)=>e.label.includes("Draft")?-1:t.label.includes("Draft")?1:0))}function u(e){return{value:e._id,label:"v".concat(e.version," - ").concat(e.deployedAt?"Deployed":"Draft")}}},32026:(e,t,n)=>{n.d(t,{G6:()=>s,Ke:()=>f,OX:()=>d,PE:()=>p,TZ:()=>h,Yq:()=>l,do:()=>u,qW:()=>c,s8:()=>r,wE:()=>v});var o=n(89379),a=n(44364);function r(e,t){return e.replace(new RegExp("".concat(i(t),"+$")),"")}function i(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e){const t=new Date(e),n=t.getDate(),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],a=t.getFullYear();return"".concat(o," ").concat(n,", ").concat(a)}function s(e,t,n){if(!t&&!e)return n;e=e||{};const a=Array.isArray(e)?[...e]:(0,o.A)({},e);if(t.includes(".")){const o=t.indexOf("."),r=t.substring(0,o),i=t.substring(o+1);a[r]=s(e[r],i,n)}else a[t]=n;return a}function c(e,t){return btoa("".concat(e,"_").concat(t,"_whatsapp_int"))}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let o=0;o<e;o++)n+=t.charAt(Math.floor(36*Math.random()));return n}function u(e,t,n){if(!t&&!e)return n;e=e||{};const a=Array.isArray(e)?[...e]:(0,o.A)({},e);if(t.includes(".")){const o=t.indexOf("."),r=t.substring(0,o),i=t.substring(o+1);a[r]=u(e[r],i,n)}else a[t]=n;return a}function p(e,t){const n=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/csv"}),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)}function f(e,t){return!t||t.startsWith("http")?t:(t.startsWith("/")&&(t=t.substring(1)),"".concat(a.J,"/").concat(e,"/").concat(t))}function h(e){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.getElementsByTagName("head")[0].appendChild(t)),null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.favicon&&(t.href=f(null===e||void 0===e?void 0:e.domain,null===e||void 0===e?void 0:e.favicon)):t.href="/favicon.png"}function v(e){null!==e&&void 0!==e&&e.domain?null!==e&&void 0!==e&&e.displayName&&(document.title=null===e||void 0===e?void 0:e.displayName):document.title="LivServ"}},42057:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var o=n(89379),a=n(9950),r=n(39320),i=n(33340),l=n(28564),s=n(32026);const c=a.createContext({}),d="start-web";const u=function(e,t){const n=(0,i.nc)((e=>e.selectedBotId)),o=(0,i.nc)((e=>e.organizationId)),[c,u]=a.useState(p(t)),f=a.useRef({flowData:c});f.current.flowId=e,f.current.flowData=c,a.useEffect((()=>{var t;e&&(null===(t=f.current.flowData)||void 0===t?void 0:t._id)!==e&&(0,l.Gl)(o,n,e).then(u)}),[e,n,o]),a.useEffect((()=>{!f.current.flowId&&t&&u(p(t))}),[t]);const h=a.useMemo((()=>{const e=[],t=[{id:d,type:"input",data:{label:"Chat window opened"},position:{x:10,y:10}}];if(!c)return{};const{_id:n,startFlowId:o,deployedAt:a,flows:i}=c;return o&&e.push({id:"start-handle",source:d,target:o,markerEnd:{type:r.TG.ArrowClosed}}),i.forEach(((n,o)=>{const a=o%4,i=Math.ceil(o/4),{designProps:l={}}=n;if(t.push({id:n.flowId,type:n.type,dragHandle:".header",data:n,position:l.position||{x:100*(a+1)+280*a,y:90*(i+1)+250*i}}),"options"===n.type)n.children.forEach((t=>{var o;const a=n.flowId,i=t.nextFlowId;t.id||(t.id=(0,s.OX)()),!t.leadEmail||null!==(o=t.settings)&&void 0!==o&&o.leadEmail||(t.settings?t.settings.leadEmail=t.leadEmail:t.settings={leadEmail:t.leadEmail},delete t.leadEmail);const l=t.id,c="".concat(a,"_").concat(l,"_").concat(i);e.push({id:c,source:a,target:i,type:"smoothstep",sourceHandle:l,markerEnd:{type:r.TG.ArrowClosed}})}));else{const t=n.flowId,o=n.nextFlowId,a="".concat(t,"_null_").concat(o);e.push({id:a,source:t,target:o,type:"smoothstep",markerEnd:{type:r.TG.ArrowClosed}})}})),{nodes:t,edges:e,flowData:c,flowId:n,allowDeploy:!a&&!!n,setFlowData:u}}),[c]);return h.organizationId=o,h.botId=n,h};function p(e){if(e)return{flows:[]}}var f=n(85668),h=n(44414);const v=function(e){let{title:t,style:n,selected:o,hideHandle:a,children:i}=e;return(0,h.jsxs)("div",{className:"flow-item-container"+(o?" selected":""),style:n,children:[(0,h.jsxs)("div",{className:"header",children:[(0,h.jsx)(r.h7,{type:"target",position:r.yX.Left}),(0,h.jsx)("span",{children:t})]}),(0,h.jsxs)("div",{className:"body",children:[!a&&(0,h.jsx)(r.h7,{type:"source",position:r.yX.Right}),i]})]})};const g=function(e){return(0,h.jsx)(v,{selected:e.selected,title:"Lead Form",children:"This will display lead form for the visitor."})};var m=n(8145);const x=function(e){let{field:t,value:n,placeholder:o="Please edit this text",onChange:r}=e;const[i,l]=a.useState(!1),[s,c]=a.useState(n),d=a.useCallback((()=>{l((e=>!e)),c(n)}),[n]),u=()=>{r(s,t),d()};return i?(0,h.jsx)(m.A,{autoFocus:!0,value:s,size:"small",onKeyUp:e=>e.stopPropagation(),placeholder:o,onBlur:u,onChange:e=>c(e.currentTarget.value)}):(0,h.jsx)("div",{className:"inline-edit"+(n?"":" placeholder"),onClick:d,children:n||o})};function y(e){const{data:t}=e,n=a.useContext(c),[o,r]=a.useState(t);a.useEffect((()=>{r(t)}),[t]);return{state:o,setState:r,setValue:(t,o)=>r((a=>{const r=(0,s.do)(a,o,t);return n.updateFlow(r,e),r}))}}const A=function(e){const{state:t,setValue:n}=y(e);return(0,h.jsx)(v,{selected:e.selected,title:"Message",style:{width:"250px",position:"relative"},children:(0,h.jsx)(x,{value:t.content,field:"content",onChange:n})})};var w=n(10226),b=n(80045);const S=["field","value","onChange"];const C=function(e){let{field:t,value:n,onChange:r}=e,i=(0,b.A)(e,S);const[l,s]=a.useState(n);return a.useEffect((()=>{s(n)}),[n]),(0,h.jsx)(m.A,(0,o.A)((0,o.A)({value:l,size:"small"},i),{},{onChange:e=>s(e.currentTarget.value),onBlur:()=>r(l,t)}))};const E={leadForm:g,message:A,options:function(e){var t,n,o,i;const{state:l,setValue:c}=y(e),[d,u]=a.useState({title:"",subTitle:"",value:""}),p=(e,t)=>u((n=>(0,s.do)(n,t,e)));return(0,h.jsxs)(v,{title:"Options",selected:e.selected,style:{width:"250px"},handleId:l.flowId,hideHandle:!0,children:[(0,h.jsx)("span",{children:"Display Text"}),(0,h.jsx)(C,{placeholder:"Display Text",value:l.displayText,field:"displayText",onChange:c}),(0,h.jsx)("span",{children:"Property Name"}),(0,h.jsx)(C,{placeholder:"Property Name",value:l.property,field:"property",onChange:c}),(0,h.jsx)("span",{children:"Message"}),(0,h.jsx)(C,{placeholder:"Display Text",value:l.content,field:"content",onChange:c}),(0,h.jsxs)("fieldset",{children:[(0,h.jsx)("legend",{children:"Add Options"}),(0,h.jsx)(C,{placeholder:"Option Title",value:d.title,field:"title",onChange:p}),(0,h.jsx)(C,{placeholder:"Option Subtitle",value:d.subTitle,field:"subTitle",onChange:p}),(0,h.jsx)(C,{placeholder:"Option value",value:d.value,field:"value",onChange:p}),(0,h.jsx)("span",{children:"Lead Email"}),(0,h.jsx)(C,{placeholder:"To Mail Id",value:null===(t=d.settings)||void 0===t||null===(n=t.leadEmail)||void 0===n?void 0:n.to,field:"settings.leadEmail.to",onChange:p}),(0,h.jsx)(C,{placeholder:"CC Mail Id",value:null===(o=d.settings)||void 0===o||null===(i=o.leadEmail)||void 0===i?void 0:i.cc,field:"settings.leadEmail.cc",onChange:p}),(0,h.jsx)(w.A,{size:"small",type:"button",variant:"contained",color:"success",onClick:()=>{c(d,"children.".concat(l.children.length)),u({title:"",subTitle:"",value:""})},children:"+"})]}),(0,h.jsx)("div",{children:l.children.map((e=>(0,h.jsxs)("div",{style:{width:"100%",padding:"4px 10px",border:"1px solid grey",borderRadius:"6px",margin:"10px 0",position:"relative"},children:[(0,h.jsx)("span",{children:e.title}),(0,h.jsx)(r.h7,{type:"source",position:r.yX.Right,id:e.id})]},e.id)))})]})},start:function(){return(0,h.jsx)("div",{children:"Start"})},gpt:function(e){return(0,h.jsx)(v,{selected:e.selected,title:"GPT Handler",children:"From here on visitors query would be handled by GPT"})},stop:function(e){return(0,h.jsx)(v,{selected:e.selected,title:"Stop Chat",hideHandle:!0,children:"The chat will stop here"})}};var I=n(93383);const _=function(e){let{name:t,type:n}=e;return(0,h.jsx)("div",{className:"flow-item",onDragStart:e=>{e.dataTransfer.setData("application/reactflow",n),e.dataTransfer.effectAllowed="move"},draggable:!0,children:t})};const T=function(e){let{list:t,onChange:n}=e;return t?(0,h.jsx)("div",{children:(0,h.jsx)("select",{onChange:e=>n(e.currentTarget.value),style:{width:"100%"},children:t.map(((e,t)=>(0,h.jsx)("option",{value:e.value,children:e.label},t)))})}):"Loading..."};const P=function(){const e=a.useContext(c);return(0,h.jsxs)("div",{className:"control-panel",children:[(0,h.jsx)("div",{children:(0,h.jsx)(T,{list:e.getFlowList(),onChange:e.selectFlow})}),(0,h.jsxs)("div",{className:"flow-items-list",children:[(0,h.jsx)(_,{name:"Message",type:"message"}),(0,h.jsx)(_,{name:"Options List",type:"options"}),(0,h.jsx)(_,{name:"Lead Form",type:"leadForm"}),(0,h.jsx)(_,{name:"Lead Flow",type:"leadFlow"}),(0,h.jsx)(_,{name:"GPT",type:"gpt"}),(0,h.jsx)(_,{name:"Stop",type:"stop"})]}),(0,h.jsxs)("div",{className:"buttons",children:[(0,h.jsx)(I.A,{variant:"contained",fullWidth:!0,color:"primary",onClick:e.saveFlow,children:"Save"}),e.allowDeploy()&&(0,h.jsx)(I.A,{variant:"contained",fullWidth:!0,style:{marginTop:"8px"},color:"secondary",onClick:e.deployFlow,children:"Deploy"})]})]})};n(522);const k=function(e){let{flowData:t}=e;const n=a.useContext(c),[i,l,d]=(0,r.ck)(t.nodes),[u,p,v]=(0,r.fM)(t.edges),[g,m]=a.useState(null),x=a.useRef({context:n});x.current.context=n,x.current.setNodes=l,x.current.onNodesChange=d,x.current.setEdges=p,x.current.reactFlowInstance=g,x.current.edges=u,a.useEffect((()=>{const{setNodes:e,setEdges:n}=x.current;e(t.nodes),n(t.edges)}),[t]),(0,r.p4)({onChange:e=>{x.current.selectedItems=e}});const y=a.useCallback((e=>p((t=>(0,r.rN)(e,t)))),[p]);x.current.onConnect=y;const A=a.useCallback((e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]),w=a.useCallback((e=>{e.preventDefault();const t=e.dataTransfer.getData("application/reactflow");if("undefined"===typeof t||!t)return;const{context:n,setNodes:a,reactFlowInstance:r}=x.current,i=r.screenToFlowPosition({x:e.clientX,y:e.clientY}),l=function(e){let t={flowId:(0,s.OX)(),type:e};"options"===e?t=(0,o.A)((0,o.A)({},t),{},{children:[],content:"",property:"",fieldLabel:""}):"message"===e&&(t=(0,o.A)((0,o.A)({},t),{},{content:""}));return t}(t),c={id:l.flowId,type:t,position:i,data:l};n.updateFlow(c.data,c),a((e=>e.concat(c)))}),[]),b=a.useCallback((function(e){const{context:t,onNodesChange:n,reactFlowInstance:o}=x.current;if(o){const n=e=>{if(!e)return;const{id:n,position:o}=e;n&&o&&t.updateFlowProperties(n,"designProps.position",o)};Array.isArray(e)?e.forEach(n):n(e)}for(var a=arguments.length,r=new Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];n(e,...r)}),[]),S=a.useCallback((function(e){const{context:t,onConnect:n}=x.current;t.updateFlowLink(e);for(var o=arguments.length,a=new Array(o>1?o-1:0),r=1;r<o;r++)a[r-1]=arguments[r];n(e,...a)}),[]),C=a.useCallback((e=>{var t;if("delete"===(null===(t=e.code)||void 0===t?void 0:t.toLowerCase())){var n;const{context:e,selectedItems:t,edges:o,setNodes:a,setEdges:r}=x.current;if(!t)return;const{nodes:i}=t;let{edges:l}=t;if(l=[...l],null!==i&&void 0!==i&&i.length&&null!==o&&void 0!==o&&o.length){const e=i.map((e=>e.id)),t=o.filter((t=>e.includes(t.target)));t.length&&l.push(...t)}if(e.remove({nodes:i,edges:l}),null!==i&&void 0!==i&&i.length){const e=i.map((e=>e.id));a((t=>t.filter((t=>!e.includes(t.id)))))}if(null!==(n=l)&&void 0!==n&&n.length){const e=l.map((e=>e.id));r((t=>t.filter((t=>!e.includes(t.id)))))}}}),[]);return(0,h.jsxs)("div",{className:"flow-design-container",children:[(0,h.jsx)("div",{className:"flow-board",onKeyUp:C,children:(0,h.jsx)(r.Gc,{nodes:i,edges:u,onNodesChange:b,onEdgesChange:v,onConnect:S,onInit:m,onDrop:w,onDragOver:A,fitView:!0,attributionPosition:"top-right",nodeTypes:E,proOptions:{hideAttribution:!0},children:(0,h.jsx)(f.V,{color:"#aaa",gap:16})})}),(0,h.jsx)(P,{})]})};const z=function(){const[e,t]=a.useState(),[n,i]=a.useState("");a.useEffect((()=>{(0,l.Ek)().then((e=>{var n;t(e),i(null===(n=e[0])||void 0===n?void 0:n.value)}))}),[]);const d=u(n,0===(null===e||void 0===e?void 0:e.length)),{flowData:p}=d||{},[f,v]=a.useState(p),g=a.useRef({});g.current.flowList=e,g.current.flow=d,g.current.state=f,a.useEffect((()=>{v(p)}),[p]);const m=a.useMemo((()=>{const e=async e=>{var n;const{state:o,flow:a}=g.current,r=await(0,l.EZ)(a.organizationId,a.botId,o,!0===e);let s=[...g.current.flowList];const c=s.findIndex((e=>e.value===r._id)),d=(0,l.CC)(r);var u,p;(c>=0?s[c]=d:s.splice(0,0,d),e||(null===(n=g.current.flow)||void 0===n?void 0:n.flowId)!==r._id)&&(t(s),i(r._id),null===(u=g.current.flow)||void 0===u||null===(p=u.setFlowData)||void 0===p||p.call(u,r))};return{getFlowList:()=>g.current.flowList,selectFlow:i,updateFlow:(e,t)=>{const{xPos:n,yPos:a}=t||{},{x:r,y:i}=(null===t||void 0===t?void 0:t.position)||{x:n,y:a};v((t=>{const n=[...t.flows];t=(0,o.A)((0,o.A)({},t),{},{flows:n});const a=n.findIndex((t=>t.flowId===e.flowId));return a>=0?n[a]=e:n.push(e),(0,s.do)(t,"designProps.position",{x:r,y:i})}))},updateFlowProperties:(e,t,n)=>{v((o=>{const a=o.flows.findIndex((t=>t.flowId===e));return a>=0?(0,s.do)(o,"flows.".concat(a,".").concat(t),n):o}))},updateFlowLink:e=>{if(!e)return;const t=(0,o.A)({},g.current.state);let n=!1;const a=e=>{const{source:o,sourceHandle:a,target:r}=e;j(t,o,a,r),n=!0};Array.isArray(e)?e.forEach(a):a(e),n&&v(t)},remove:e=>{let{nodes:t,edges:n}=e;if((null===t||void 0===t||!t.length)&&(null===n||void 0===n||!n.length))return;const a=(0,o.A)({},g.current.state);if(null===n||void 0===n||n.forEach((e=>{const{source:t,sourceHandle:n}=e;j(a,t,n)})),null!==t&&void 0!==t&&t.length){const e=t.map((e=>e.id));a.flows=a.flows.filter((t=>!e.includes(t.flowId)))}v(a)},allowDeploy:()=>{var e;return null===(e=g.current.flow)||void 0===e?void 0:e.allowDeploy},saveFlow:()=>e(!1),deployFlow:()=>e(!0)}}),[]);if(p)return(0,h.jsx)(c.Provider,{value:m,children:(0,h.jsx)(r.Ln,{children:(0,h.jsx)(k,{flowData:d})})})};function j(e,t,n,a){if(t===d)e.startFlowId=a||void 0;else{const i=e.flows.findIndex((e=>e.flowId===t));if(i>=0){const t=(0,o.A)({},e.flows[i]);if(e.flows=[...e.flows],e.flows[i]=t,n){if(t.children){var r;const e=null===(r=t.children)||void 0===r?void 0:r.findIndex((e=>e.id===n));if(e>=0){t.children[e].nextFlowId=a||void 0}}}else t.nextFlowId=a||void 0}}}},44364:(e,t,n)=>{n.d(t,{DX:()=>c,J:()=>s,Og:()=>r,jn:()=>o,mB:()=>l,pA:()=>i,pR:()=>a});const o="https://backend.livhousing.com",a="c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://backend.livhousing.com"}.TRAINING_MEDIA_MAXSIZE,i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://backend.livhousing.com"}.CONVERSATION_MEDIA_MAXSIZE,l="AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",s="https://livserv-organizations.s3.ap-south-1.amazonaws.com",c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_IP_DATA_API_KEY:"c17b949cf58c45cae47ce1cc65efc8240f77a2a69ca09ad4c4208852",REACT_APP_VERSION:"1",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyAQMYGdP2AmloNtJm4ZDrJxPuSfuo2RSXM",REACT_APP_BACKEND_URL:"https://backend.livhousing.com"}.REACT_APP_NGROK_BACKEND_URL||"https://backend.livhousing.com"},46639:(e,t,n)=>{n.d(t,{A:()=>j});var o=n(57528),a=n(98587),r=n(58168),i=n(9950),l=n(72004),s=n(88465),c=n(88283),d=n(61676),u=n(18463),p=n(59254),f=n(1763),h=n(423);function v(e){return(0,h.Ay)("MuiCircularProgress",e)}(0,f.A)("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);var g,m,x,y,A=n(44414);const w=["className","color","disableShrink","size","style","thickness","value","variant"];let b,S,C,E;const I=44,_=(0,c.i7)(b||(b=g||(g=(0,o.A)(["\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n"])))),T=(0,c.i7)(S||(S=m||(m=(0,o.A)(["\n  0% {\n    stroke-dasharray: 1px, 200px;\n    stroke-dashoffset: 0;\n  }\n\n  50% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -15px;\n  }\n\n  100% {\n    stroke-dasharray: 100px, 200px;\n    stroke-dashoffset: -125px;\n  }\n"])))),P=(0,p.Ay)("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t["color".concat((0,d.A)(n.color))]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,r.A)({display:"inline-block"},"determinate"===t.variant&&{transition:n.transitions.create("transform")},"inherit"!==t.color&&{color:(n.vars||n).palette[t.color].main})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&(0,c.AH)(C||(C=x||(x=(0,o.A)(["\n      animation: "," 1.4s linear infinite;\n    "]))),_)})),k=(0,p.Ay)("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),z=(0,p.Ay)("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t["circle".concat((0,d.A)(n.variant))],n.disableShrink&&t.circleDisableShrink]}})((e=>{let{ownerState:t,theme:n}=e;return(0,r.A)({stroke:"currentColor"},"determinate"===t.variant&&{transition:n.transitions.create("stroke-dashoffset")},"indeterminate"===t.variant&&{strokeDasharray:"80px, 200px",strokeDashoffset:0})}),(e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink&&(0,c.AH)(E||(E=y||(y=(0,o.A)(["\n      animation: "," 1.4s ease-in-out infinite;\n    "]))),T)})),j=i.forwardRef((function(e,t){const n=(0,u.b)({props:e,name:"MuiCircularProgress"}),{className:o,color:i="primary",disableShrink:c=!1,size:p=40,style:f,thickness:h=3.6,value:g=0,variant:m="indeterminate"}=n,x=(0,a.A)(n,w),y=(0,r.A)({},n,{color:i,disableShrink:c,size:p,thickness:h,value:g,variant:m}),b=(e=>{const{classes:t,variant:n,color:o,disableShrink:a}=e,r={root:["root",n,"color".concat((0,d.A)(o))],svg:["svg"],circle:["circle","circle".concat((0,d.A)(n)),a&&"circleDisableShrink"]};return(0,s.A)(r,v,t)})(y),S={},C={},E={};if("determinate"===m){const e=2*Math.PI*((I-h)/2);S.strokeDasharray=e.toFixed(3),E["aria-valuenow"]=Math.round(g),S.strokeDashoffset="".concat(((100-g)/100*e).toFixed(3),"px"),C.transform="rotate(-90deg)"}return(0,A.jsx)(P,(0,r.A)({className:(0,l.A)(b.root,o),style:(0,r.A)({width:p,height:p},C,f),ownerState:y,ref:t,role:"progressbar"},E,x,{children:(0,A.jsx)(k,{className:b.svg,ownerState:y,viewBox:"".concat(22," ").concat(22," ").concat(I," ").concat(I),children:(0,A.jsx)(z,{className:b.circle,style:S,ownerState:y,cx:I,cy:I,r:(I-h)/2,fill:"none",strokeWidth:h})})}))}))},80045:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(98587);function a(e,t){if(null==e)return{};var n,a,r=(0,o.A)(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}},93383:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(89379),a=n(80045),r=n(9950),i=n(10226),l=n(46639),s=n(44414);const c=["onClick","disabled","isLoading","children"];const d=function(e){let{onClick:t,disabled:n,isLoading:d,children:u}=e,p=(0,a.A)(e,c);const[f,h]=r.useState(d);return(0,s.jsxs)(i.A,(0,o.A)((0,o.A)({onClick:e=>{if(!t)return;const n=t(e);"function"===typeof(null===n||void 0===n?void 0:n.finally)&&(h(!0),n.finally((()=>h(!1))))},disabled:f||d||n},p),{},{children:[(f||d)&&(0,s.jsx)(l.A,{size:16,color:"primary",style:{marginRight:"10px"}}),u]}))}}}]);